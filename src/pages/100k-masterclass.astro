---
import Layout from "../layouts/Layout.astro";
---

<Layout
    title="Webinaire Exclusif - Comment j'ai fait +100k‚Ç¨ en 1 mois | Syst√®me Viral"
    description="D√©couvrez la m√©thode exacte pour g√©n√©rer +100k‚Ç¨ en 1 mois avec des vid√©os d'1 minute. Webinaire gratuit avec chat en direct."
    canonical="/100k-masterclass"
>
    <!-- Background effects -->
    <div class="gradient-bg"></div>

    <!-- Page Title -->
    <section class="page-title-section">
        <div class="container">
            <div class="title-badge">
                <span class="badge-dot"></span>
                <span>Session Exclusive</span>
            </div>
            <h1 class="page-title">
                Les <span class="title-highlight">3 secrets</span> pour cr√©er ton
                audience, obtenir tes premiers emails et g√©n√©rer des
                <span class="title-highlight">revenus passifs</span>.
            </h1>
            <p class="title-subtitle">
                Une masterclass d'exception pour transformer ta passion en
                revenus r√©currents.
            </p>
        </div>
    </section>

    <!-- Main Content -->
    <div class="main-container">
        <!-- Left Column: Video + Info -->
        <div class="video-section">
            <div class="video-wrapper">
                <video
                    id="masterclass-video"
                    controls
                    playsinline
                    preload="metadata"
                >
                    <source
                        src="https://sonnycourt-videos-public.b-cdn.net/VSL-Systeme-Viral-VF.mp4"
                        type="video/mp4"
                    />
                    Votre navigateur ne supporte pas la lecture vid√©o.
                </video>
                <div class="reactions-overlay" id="reactionsOverlay"></div>
            </div>

            <div class="video-info">
                <div class="video-chapters">
                    <div class="chapter active" data-time="0" data-chapter="0">
                        L'introduction
                    </div>
                    <div class="chapter" data-time="300" data-chapter="1">
                        La preuve
                    </div>
                    <div class="chapter" data-time="600" data-chapter="2">
                        Le secret #1
                    </div>
                    <div class="chapter" data-time="900" data-chapter="3">
                        Le secret #2
                    </div>
                    <div class="chapter" data-time="1200" data-chapter="4">
                        Le secret #3
                    </div>
                    <div class="chapter" data-time="1500" data-chapter="5">
                        Le mensonge
                    </div>
                    <div class="chapter" data-time="1800" data-chapter="6">
                        La solution
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Column: Chat (same height as video) -->
        <div class="chat-wrapper">
            <div class="chat-section">
                <!-- Header avec statut -->
                <div class="chat-header">
                    <div class="chat-status">
                        <div class="live-dot"></div>
                        <span>Replay interactif</span>
                    </div>
                    <div class="viewers-count">
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            width="16"
                            height="16"
                            viewBox="0 0 24 24"
                            fill="none"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            class="viewers-icon"
                        >
                            <path
                                d="M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"
                            ></path>
                            <circle cx="12" cy="12" r="3"></circle>
                        </svg>
                        <span id="viewerCount">32</span>
                        <span> personnes regardent</span>
                    </div>
                </div>

                <!-- Onglets -->
                <div class="chat-tabs" style="display: none;">
                    <button
                        class="chat-tab active"
                        id="publicTab"
                        data-tab="public"
                    >
                        <span>Chat</span>
                    </button>
                </div>

                <!-- Contenu onglet Discussion publique -->
                <div class="tab-content active" id="publicContent">
                    <div class="chat-messages" id="chatMessages">
                        <div class="system-message join">
                            <span id="welcomeMessage"></span>
                        </div>
                    </div>

                    <div class="chat-input-wrapper">
                        <form class="chat-input-form" id="chatForm">
                            <input
                                type="text"
                                class="chat-input"
                                id="chatInput"
                                placeholder="Posez votre question..."
                                required
                            />
                            <button type="submit" class="chat-send">
                                Envoyer
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Timer Button -->
        <div class="timer-section">
            <button class="timer-button disabled" id="timerButton" disabled>
                <div class="timer-glow"></div>
                <div class="timer-content">
                    <div class="timer-top">
                        <span class="timer-label" id="timerLabel"
                            >ACC√àS LIMIT√â</span
                        >
                    </div>
                    <div class="timer-display">
                        <span class="timer-countdown" id="timerCountdown"
                            >12:00</span
                        >
                    </div>
                    <div class="timer-cta" id="timerCTA">
                        <span>D√©bloquer l'acc√®s</span>
                        <svg
                            width="20"
                            height="20"
                            viewBox="0 0 20 20"
                            fill="none"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <path
                                d="M7.5 15L12.5 10L7.5 5"
                                stroke="currentColor"
                                stroke-width="2"
                                stroke-linecap="round"
                                stroke-linejoin="round"></path>
                        </svg>
                    </div>
                </div>
            </button>
        </div>
    </div>

    <!-- CTA Popup -->
    <div class="cta-popup" id="ctaPopup">
        <span class="cta-text">üéÅ T√©l√©chargez le guide PDF gratuit</span>
        <button class="cta-button" onclick="handleCTA()">T√âL√âCHARGER</button>
        <button class="cta-close" onclick="closeCTA()">√ó</button>
    </div>
</Layout>

<style>
    /* Variables CSS adapt√©es au branding Syst√®me Viral */
    :root {
        --bg: #0a0a0a;
        --bg-card: rgba(255, 255, 255, 0.02);
        --bg-elevated: rgba(255, 255, 255, 0.05);
        --text: #ffffff;
        --text-secondary: #aaa;
        --text-muted: #888;
        --accent: #00dc82;
        --accent-bright: #00f593;
        --accent-glow: #00dc82;
        --accent-dark: #00b86b;
        --success: #00dc82;
        --border: rgba(255, 255, 255, 0.1);
        --glow: rgba(0, 220, 130, 0.3);
        --danger: #ef4444;
    }

    /* Background effects */
    .gradient-bg {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: #0a0a0a;
        z-index: -1;
    }

    /* Page Title Section */
    .page-title-section {
        background: var(--bg);
        padding: 80px 0 32px;
        text-align: center;
        position: relative;
        overflow: hidden;
    }

    .page-title-section::before {
        content: "";
        position: absolute;
        top: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 600px;
        height: 400px;
        background: radial-gradient(
            circle,
            rgba(0, 220, 130, 0.1) 0%,
            transparent 70%
        );
        pointer-events: none;
        animation: titleGlow 8s ease-in-out infinite;
    }

    @keyframes titleGlow {
        0%,
        100% {
            opacity: 0.3;
            transform: translateX(-50%) scale(1);
        }
        50% {
            opacity: 0.6;
            transform: translateX(-50%) scale(1.2);
        }
    }

    .title-badge {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 8px 20px;
        background: rgba(0, 220, 130, 0.1);
        border: 1px solid rgba(0, 220, 130, 0.3);
        border-radius: 100px;
        margin-bottom: 32px;
        font-size: 13px;
        font-weight: 600;
        color: var(--accent-bright);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        animation: fadeInDown 0.6s ease;
    }

    .badge-dot {
        width: 8px;
        height: 8px;
        background: var(--accent);
        border-radius: 50%;
        animation: pulse 2s ease infinite;
        box-shadow: 0 0 10px var(--accent);
    }

    @keyframes fadeInDown {
        from {
            opacity: 0;
            transform: translateY(-20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .page-title {
        font-size: clamp(28px, 5vw, 48px);
        font-weight: 900;
        line-height: 1.2;
        color: var(--text);
        max-width: 900px;
        margin: 0 auto 24px;
        letter-spacing: -0.02em;
        position: relative;
        z-index: 1;
        animation: fadeInUp 0.8s ease 0.2s both;
        text-shadow: 0 2px 20px rgba(0, 220, 130, 0.2);
    }

    .title-highlight {
        background: linear-gradient(
            135deg,
            var(--accent) 0%,
            var(--accent-bright) 100%
        );
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        position: relative;
        font-weight: 900;
        display: inline-block;
    }

    .title-subtitle {
        font-size: 18px;
        color: var(--text-secondary);
        max-width: 600px;
        margin: 0 auto;
        line-height: 1.6;
        animation: fadeInUp 1s ease 0.4s both;
        position: relative;
        z-index: 1;
    }

    @media (max-width: 768px) {
        .page-title {
            font-size: 24px;
            padding: 0 16px;
            margin-bottom: 16px;
        }

        .page-title-section {
            padding: 60px 0 32px;
        }

        .title-badge {
            font-size: 11px;
            padding: 6px 16px;
            margin-bottom: 24px;
        }

        .title-subtitle {
            font-size: 16px;
            padding: 0 16px;
        }
    }

    .live-dot {
        width: 8px;
        height: 8px;
        background: var(--accent);
        border-radius: 50%;
        animation: pulse 2s ease infinite;
    }

    @keyframes pulse {
        0%,
        100% {
            opacity: 1;
            box-shadow: 0 0 0 0 var(--accent);
        }
        50% {
            opacity: 0.7;
            box-shadow: 0 0 0 8px rgba(16, 185, 129, 0);
        }
    }

    /* Main Layout */
    .main-container {
        max-width: 1400px;
        margin: 40px auto 0;
        padding: 24px;
        display: grid;
        grid-template-columns: 1fr 380px;
        grid-template-areas:
            "video chat"
            "video timer";
        gap: 24px;
        align-items: start;
    }

    /* Video Section */
    .video-section {
        grid-area: video;
        display: flex;
        flex-direction: column;
        gap: 20px;
        align-items: start;
    }

    .video-wrapper {
        background: var(--bg-card);
        border: 1px solid var(--border);
        border-radius: 16px;
        overflow: hidden;
        position: relative;
        width: 100%;
        aspect-ratio: 16/9;
    }

    .video-wrapper iframe {
        width: 100%;
        height: 100%;
        border: none;
    }

    .video-wrapper video {
        width: 100%;
        height: 100%;
        display: block;
        background: #000;
    }

    /* Reactions overlay */
    .reactions-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        pointer-events: none;
        z-index: 10;
    }

    .floating-reaction {
        position: absolute;
        font-size: 24px;
        animation: floatUp 3s ease-out forwards;
        pointer-events: none;
    }

    @keyframes floatUp {
        0% {
            opacity: 0;
            transform: translateY(0) scale(0);
        }
        20% {
            opacity: 1;
            transform: translateY(-20px) scale(1);
        }
        100% {
            opacity: 0;
            transform: translateY(-100px) scale(0.5);
        }
    }

    /* Video Info */
    .video-info {
        background: var(--bg-card);
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 20px;
    }

    .video-title {
        font-size: 20px;
        font-weight: 700;
        margin-bottom: 20px;
        letter-spacing: -0.5px;
        color: var(--text);
    }

    /* Timer Section */
    .timer-section {
        grid-area: timer;
        width: 100%;
    }

    .timer-button {
        width: 100%;
        background: linear-gradient(
            135deg,
            rgba(0, 220, 130, 0.03) 0%,
            rgba(0, 220, 130, 0.08) 50%,
            rgba(0, 220, 130, 0.03) 100%
        );
        border: 2px solid rgba(0, 220, 130, 0.3);
        border-radius: 24px;
        padding: 32px 40px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
        backdrop-filter: blur(20px);
        box-shadow: 0 8px 32px rgba(0, 220, 130, 0.15);
    }

    .timer-glow {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 200%;
        height: 200%;
        background: radial-gradient(
            circle,
            rgba(0, 220, 130, 0.15) 0%,
            transparent 70%
        );
        animation: glowPulse 3s ease-in-out infinite;
        pointer-events: none;
    }

    @keyframes glowPulse {
        0%,
        100% {
            opacity: 0.5;
            transform: translate(-50%, -50%) scale(1);
        }
        50% {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1.1);
        }
    }

    .timer-content {
        position: relative;
        z-index: 1;
        text-align: center;
        width: 100%;
    }

    .timer-top {
        margin-bottom: 12px;
    }

    .timer-label {
        font-size: 13px;
        font-weight: 800;
        color: var(--text-secondary);
        text-transform: uppercase;
        letter-spacing: 3px;
        transition: all 0.3s ease;
        display: inline-block;
    }

    .timer-display {
        margin-bottom: 20px;
    }

    .timer-countdown {
        font-size: 56px;
        font-weight: 900;
        font-family: "SF Mono", "Monaco", "Courier New", monospace;
        color: #fff;
        letter-spacing: 4px;
        transition: all 0.3s ease;
        text-shadow: 0 0 40px rgba(0, 220, 130, 0.5);
        display: block;
        line-height: 1;
    }

    .timer-cta {
        display: inline-flex;
        align-items: center;
        gap: 12px;
        padding: 16px 32px;
        background: linear-gradient(
            135deg,
            var(--accent) 0%,
            var(--accent-bright) 100%
        );
        color: #000;
        border-radius: 100px;
        font-size: 16px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 1px;
        transition: all 0.3s ease;
        box-shadow: 0 4px 20px rgba(0, 220, 130, 0.3);
    }

    .timer-cta svg {
        transition: all 0.3s ease;
    }

    /* Hover states - actif seulement */
    .timer-button:not(.disabled):hover {
        transform: translateY(-8px);
        border-color: var(--accent-bright);
        background: linear-gradient(
            135deg,
            rgba(0, 220, 130, 0.08) 0%,
            rgba(0, 220, 130, 0.15) 50%,
            rgba(0, 220, 130, 0.08) 100%
        );
        box-shadow: 0 20px 60px rgba(0, 220, 130, 0.4);
    }

    .timer-button:not(.disabled):hover .timer-countdown {
        text-shadow: 0 0 60px rgba(0, 220, 130, 0.8);
    }

    .timer-button:not(.disabled):hover .timer-cta {
        background: linear-gradient(
            135deg,
            var(--accent-bright) 0%,
            var(--accent-glow) 100%
        );
        box-shadow: 0 8px 32px rgba(0, 220, 130, 0.5);
        transform: scale(1.05);
    }

    .timer-button:not(.disabled):hover .timer-cta svg {
        transform: translateX(4px);
    }

    .timer-button:not(.disabled):active {
        transform: translateY(-4px) scale(0.98);
    }

    /* √âtat d√©sactiv√© - Plus visible */
    .timer-button.disabled {
        cursor: not-allowed;
        background: linear-gradient(
            135deg,
            rgba(255, 255, 255, 0.03) 0%,
            rgba(255, 255, 255, 0.06) 50%,
            rgba(255, 255, 255, 0.03) 100%
        );
        border: 2px solid rgba(255, 255, 255, 0.15);
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    }

    .timer-button.disabled .timer-glow {
        display: none;
    }

    .timer-button.disabled .timer-countdown {
        color: rgba(255, 255, 255, 0.7);
        text-shadow: none;
        font-size: 36px;
    }

    .timer-button.disabled .timer-label {
        color: rgba(255, 255, 255, 0.6);
    }

    .timer-button.disabled .timer-cta {
        opacity: 0.5;
        background: rgba(255, 255, 255, 0.08);
        color: rgba(255, 255, 255, 0.5);
        border: 1px solid rgba(255, 255, 255, 0.1);
        box-shadow: none;
    }

    .video-chapters {
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
    }

    .chapter {
        padding: 8px 16px 12px;
        background: var(--bg-elevated);
        border: 1px solid var(--border);
        border-radius: 10px;
        font-size: 13px;
        color: var(--text-secondary);
        cursor: pointer;
        transition: all 0.4s ease;
        position: relative;
        overflow: hidden;
        font-weight: 500;
    }

    .chapter::before {
        content: "";
        position: absolute;
        left: 0;
        top: 0;
        height: 100%;
        width: 0%;
        background: linear-gradient(
            90deg,
            rgba(0, 220, 130, 0.15) 0%,
            rgba(0, 220, 130, 0.08) 100%
        );
        transition: width 0.3s ease;
        z-index: -1;
    }

    /* Barre de progression en bas du chapitre actif */
    .chapter::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 0;
        height: 3px;
        width: 0%;
        background: linear-gradient(
            90deg,
            var(--accent) 0%,
            var(--accent-bright) 100%
        );
        box-shadow: 0 0 10px rgba(0, 220, 130, 0.6);
        transition: none;
        opacity: 0;
    }

    .chapter:hover {
        border-color: var(--accent);
        color: var(--accent);
        transform: translateY(-2px);
    }

    .chapter.active {
        background: rgba(0, 220, 130, 0.15);
        border-color: var(--accent);
        color: var(--accent-bright);
        box-shadow: 0 0 20px rgba(0, 220, 130, 0.3);
        font-weight: 600;
    }

    .chapter.active::before {
        width: 100%;
        animation: shimmer 2s ease-in-out infinite;
    }

    .chapter.active::after {
        opacity: 1;
        width: var(--chapter-progress, 0%);
    }

    @keyframes shimmer {
        0%,
        100% {
            opacity: 1;
        }
        50% {
            opacity: 0.5;
        }
    }

    .chapter.completed {
        background: rgba(0, 220, 130, 0.05);
        border-color: rgba(0, 220, 130, 0.3);
        color: var(--accent);
    }

    .chapter.completed::after {
        opacity: 0 !important;
        width: 0 !important;
    }

    /* Chat Wrapper */
    .chat-wrapper {
        grid-area: chat;
        position: sticky;
        top: 100px;
        height: fit-content;
    }

    /* Chat Section */
    .chat-section {
        background: var(--bg-card);
        border: 1px solid var(--border);
        border-radius: 16px;
        display: flex;
        flex-direction: column;
        height: 520px;
        max-height: 520px;
        overflow: hidden;
    }

    /* Header du chat */
    .chat-header {
        padding: 12px 20px;
        border-bottom: 1px solid var(--border);
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 16px;
    }

    .chat-status {
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 12px;
        color: var(--text-secondary);
    }

    .viewers-count {
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 12px;
        color: var(--text-secondary);
    }

    .viewers-icon {
        font-size: 14px;
        width: 16px;
        height: 16px;
        color: var(--accent-bright);
    }

    #viewerCount {
        font-weight: 700;
        color: var(--accent-bright);
        transition: all 0.3s ease;
    }

    @keyframes countPulse {
        0%,
        100% {
            transform: scale(1);
        }
        50% {
            transform: scale(1.1);
        }
    }

    #viewerCount.updating {
        animation: countPulse 0.5s ease;
    }

    /* Onglets du chat */
    .chat-tabs {
        display: flex;
        border-bottom: 1px solid var(--border);
        background: var(--bg);
    }

    .chat-tab {
        flex: 1;
        padding: 14px 16px;
        background: transparent;
        border: none;
        border-bottom: 2px solid transparent;
        color: var(--text-secondary);
        font-size: 13px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        position: relative;
    }

    .chat-tab:hover {
        background: rgba(255, 255, 255, 0.03);
        color: var(--text);
    }

    .chat-tab.active {
        color: var(--accent-bright);
        border-bottom-color: var(--accent);
        background: rgba(0, 220, 130, 0.05);
    }

    .tab-notification {
        position: absolute;
        top: 8px;
        right: 8px;
        width: 20px;
        height: 20px;
        background: #ef4444;
        color: white;
        border-radius: 50%;
        font-size: 11px;
        font-weight: 700;
        display: flex;
        align-items: center;
        justify-content: center;
        animation: notifPulse 2s ease-in-out infinite;
        box-shadow: 0 0 10px rgba(239, 68, 68, 0.5);
    }

    .tab-notification.hidden {
        display: none;
    }

    @keyframes notifPulse {
        0%,
        100% {
            transform: scale(1);
        }
        50% {
            transform: scale(1.1);
        }
    }

    /* Contenu des onglets */
    .tab-content {
        display: none;
        flex-direction: column;
        flex: 1;
        overflow: hidden;
    }

    .tab-content.active {
        display: flex;
    }

    /* Header de l'onglet IA */
    .ai-header {
        padding: 20px;
        background: linear-gradient(
            135deg,
            rgba(0, 220, 130, 0.1) 0%,
            rgba(0, 220, 130, 0.05) 100%
        );
        border-bottom: 1px solid rgba(0, 220, 130, 0.3);
        display: flex;
        align-items: center;
        gap: 16px;
    }

    .ai-avatar-large {
        width: 56px;
        height: 56px;
        background: linear-gradient(
            135deg,
            var(--accent) 0%,
            var(--accent-bright) 100%
        );
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 28px;
        box-shadow: 0 0 30px rgba(0, 220, 130, 0.5);
        animation: avatarGlow 2s ease-in-out infinite;
    }

    @keyframes avatarGlow {
        0%,
        100% {
            box-shadow: 0 0 30px rgba(0, 220, 130, 0.5);
        }
        50% {
            box-shadow: 0 0 40px rgba(0, 220, 130, 0.7);
        }
    }

    .ai-title {
        flex: 1;
    }

    .ai-name-large {
        font-size: 16px;
        font-weight: 700;
        color: var(--accent-bright);
        margin-bottom: 4px;
    }

    .ai-badge-live {
        display: inline-block;
        padding: 3px 8px;
        background: rgba(220, 38, 38, 0.15);
        color: #ef4444;
        border: 1px solid rgba(220, 38, 38, 0.3);
        border-radius: 6px;
        font-size: 9px;
        font-weight: 800;
        letter-spacing: 0.5px;
        animation: livePulse 2s ease-in-out infinite;
    }

    @keyframes livePulse {
        0%,
        100% {
            opacity: 1;
        }
        50% {
            opacity: 0.7;
        }
    }

    .chat-messages {
        flex: 1;
        overflow-y: auto;
        padding: 20px;
        display: flex;
        flex-direction: column;
        gap: 16px;
    }

    .chat-messages::-webkit-scrollbar {
        width: 6px;
    }

    .chat-messages::-webkit-scrollbar-track {
        background: var(--bg-elevated);
    }

    .chat-messages::-webkit-scrollbar-thumb {
        background: var(--border);
        border-radius: 3px;
    }

    .chat-messages::-webkit-scrollbar-thumb:hover {
        background: var(--text-muted);
    }

    .chat-message {
        animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
        from {
            opacity: 0;
            transform: translateX(-10px);
        }
        to {
            opacity: 1;
            transform: translateX(0);
        }
    }

    .message-header {
        display: flex;
        align-items: baseline;
        gap: 8px;
    }

    .message-author {
        font-size: 13px;
        font-weight: 600;
        margin-bottom: 0;
        display: flex;
        align-items: center;
        gap: 6px;
        color: var(--accent-bright);
    }

    /* Couleurs coh√©rentes avec le style vert n√©on du site */
    .message-author.color-1 {
        color: #00dc82 !important; /* Accent principal */
    }
    .message-author.color-2 {
        color: #00f593 !important; /* Accent bright */
    }
    .message-author.color-3 {
        color: #10b981 !important; /* Emerald */
    }
    .message-author.color-4 {
        color: #34d399 !important; /* Emerald light */
    }
    .message-author.color-5 {
        color: #6ee7b7 !important; /* Emerald lighter */
    }
    .message-author.color-6 {
        color: #14b8a6 !important; /* Teal */
    }
    .message-author.color-7 {
        color: #2dd4bf !important; /* Teal light */
    }
    .message-author.color-8 {
        color: #5eead4 !important; /* Teal lighter */
    }
    .message-author.color-9 {
        color: #22c55e !important; /* Green */
    }
    .message-author.color-10 {
        color: #4ade80 !important; /* Green light */
    }
    .message-author.color-11 {
        color: #86efac !important; /* Green lighter */
    }
    .message-author.color-12 {
        color: #06b6d4 !important; /* Cyan */
    }
    .message-author.color-13 {
        color: #22d3ee !important; /* Cyan light */
    }
    .message-author.color-14 {
        color: #67e8f9 !important; /* Cyan lighter */
    }
    .message-author.color-15 {
        color: #0891b2 !important; /* Cyan dark */
    }
    .message-author.color-16 {
        color: #84cc16 !important; /* Lime */
    }
    .message-author.color-17 {
        color: #a3e635 !important; /* Lime light */
    }
    .message-author.color-18 {
        color: #bef264 !important; /* Lime lighter */
    }
    .message-author.color-19 {
        color: #00b86b !important; /* Accent dark */
    }
    .message-author.color-20 {
        color: #10b981 !important; /* Emerald variant */
    }
    .message-author.color-user {
        color: var(--accent) !important;
    }

    .message-badge {
        padding: 3px 8px;
        background: linear-gradient(
            135deg,
            rgba(0, 220, 130, 0.2) 0%,
            rgba(0, 245, 147, 0.15) 100%
        );
        color: var(--accent-bright);
        border: 1px solid rgba(0, 220, 130, 0.3);
        border-radius: 6px;
        font-size: 9px;
        font-weight: 800;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        box-shadow: 0 0 10px rgba(0, 220, 130, 0.2);
        animation: badgePulse 2s ease-in-out infinite;
    }

    @keyframes badgePulse {
        0%,
        100% {
            box-shadow: 0 0 10px rgba(0, 220, 130, 0.2);
        }
        50% {
            box-shadow: 0 0 15px rgba(0, 220, 130, 0.4);
        }
    }

    .message-content {
        font-size: 14px;
        color: var(--text-secondary);
        line-height: 1.5;
        font-weight: 400;
    }

    /* System messages */
    .system-message {
        text-align: center;
        padding: 8px;
        background: var(--bg-elevated);
        border-radius: 8px;
        font-size: 12px;
        color: var(--text-muted);
        font-style: italic;
    }

    .system-message.join {
        color: var(--accent);
        background: rgba(16, 185, 129, 0.1);
    }

    /* Chat Input */
    .chat-input-wrapper {
        padding: 16px;
        border-top: 1px solid var(--border);
    }

    .chat-input-form {
        display: flex;
        gap: 8px;
    }

    .chat-input {
        flex: 1;
        padding: 10px 16px;
        background: var(--bg);
        border: 1px solid var(--border);
        border-radius: 8px;
        color: var(--text);
        font-size: 14px;
        font-family: inherit;
        transition: all 0.2s ease;
    }

    .chat-input:focus {
        outline: none;
        border-color: var(--accent);
        box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
    }

    .chat-input::placeholder {
        color: var(--text-muted);
    }

    .chat-send {
        padding: 10px 20px;
        background: var(--accent);
        color: var(--bg);
        border: none;
        border-radius: 8px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s ease;
    }

    .chat-send:hover {
        background: var(--accent-bright);
        transform: translateY(-1px);
    }

    /* CTA Popup */
    .cta-popup {
        position: fixed;
        bottom: 24px;
        left: 50%;
        transform: translateX(-50%) translateY(200px);
        background: linear-gradient(
            135deg,
            var(--accent) 0%,
            var(--accent-dark) 100%
        );
        padding: 16px 24px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        gap: 16px;
        box-shadow: 0 10px 40px rgba(16, 185, 129, 0.4);
        z-index: 200;
        transition: transform 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }

    .cta-popup.show {
        transform: translateX(-50%) translateY(0);
    }

    .cta-text {
        color: var(--bg);
        font-weight: 600;
        font-size: 14px;
    }

    .cta-button {
        padding: 8px 16px;
        background: var(--bg);
        color: var(--accent);
        border: none;
        border-radius: 8px;
        font-weight: 700;
        cursor: pointer;
        text-transform: uppercase;
        font-size: 12px;
        letter-spacing: 0.5px;
    }

    .cta-close {
        width: 24px;
        height: 24px;
        background: rgba(0, 0, 0, 0.2);
        border: none;
        border-radius: 50%;
        color: var(--bg);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    /* Responsive */
    /* Tablette et desktop moyen (769px - 1024px) */
    @media (max-width: 1024px) {
        .main-container {
            grid-template-columns: 1fr;
            grid-template-areas:
                "video"
                "timer"
                "chat";
            gap: 24px;
        }

        .chat-wrapper {
            position: static;
        }

        .chat-section {
            height: 520px;
        }
    }

    /* Mobile (‚â§768px) */
    @media (max-width: 768px) {
        .main-container {
            padding: 16px;
            margin-top: 24px;
            grid-template-areas:
                "video"
                "timer"
                "chat";
            gap: 20px;
        }

        .video-title {
            font-size: 18px;
        }

        .chapter {
            font-size: 12px;
            padding: 6px 12px 10px;
        }

        .timer-button {
            padding: 28px 24px;
        }

        .timer-label {
            font-size: 11px;
            letter-spacing: 2px;
        }

        .timer-countdown {
            font-size: 48px;
            letter-spacing: 4px;
        }

        .timer-display {
            margin-bottom: 20px;
        }

        .timer-cta {
            padding: 14px 28px;
            font-size: 14px;
        }

        .timer-cta svg {
            width: 18px;
            height: 18px;
        }

        .chat-tab {
            font-size: 12px;
            padding: 12px 12px;
        }

        .ai-avatar-large {
            width: 48px;
            height: 48px;
            font-size: 24px;
        }

        .ai-name-large {
            font-size: 14px;
        }

        .ai-header {
            padding: 16px;
        }

        .chat-header {
            flex-wrap: wrap;
            padding: 12px 16px;
        }

        .viewers-count {
            font-size: 11px;
            margin-top: 4px;
            width: 100%;
            justify-content: center;
        }
    }
</style>

<script>
    // Simulated chat messages with timestamps (in seconds)
    const scheduledMessages = [
        {
            time: 5,
            author: "Marie",
            message: "Super excit√© !",
            badge: null,
        },
        {
            time: 30,
            author: "Thomas",
            message: "Wow ü§Ø",
            badge: null,
        },
        {
            time: 60,
            author: "Sophie",
            message: "Trop bien",
            badge: null,
        },
        { time: 90, type: "reaction", emoji: "üî•" },
        {
            time: 120,
            author: "Lucas",
            message: "Merci !",
            badge: null,
        },
        {
            time: 180,
            author: "Emma",
            message: "Top üíé",
            badge: null,
        },
        { time: 240, type: "reaction", emoji: "üí∞" },
        {
            time: 300,
            author: "Alex",
            message: "G√©nial",
            badge: null,
        },
        {
            time: 420,
            author: "Julie",
            message: "Incroyable",
            badge: null,
        },
        { time: 540, type: "reaction", emoji: "üöÄ" },
        {
            time: 600,
            author: "Marc",
            message: "J'adore",
            badge: null,
        },
    ];

    // Chat functions
    const chatMessages = document.getElementById("chatMessages");

    // R√©cup√©rer le pr√©nom de l'utilisateur depuis localStorage
    const userFirstName = localStorage.getItem("userFirstName") || "Vous";

    // Display initial messages on load
    window.addEventListener("DOMContentLoaded", () => {
        // Message de bienvenue personnalis√©
        const welcomeMessage = document.getElementById("welcomeMessage");
        if (welcomeMessage) {
            if (userFirstName !== "Vous") {
                welcomeMessage.textContent = `Bienvenue ${userFirstName} ! La session a commenc√©`;
            } else {
                welcomeMessage.textContent = "La session a commenc√©";
            }
        }

        scheduledMessages.forEach((msg) => {
            if (msg.type !== "reaction" && msg.type !== "system") {
                setTimeout(() => {
                    addChatMessage(
                        msg.author || "",
                        msg.message || "",
                        msg.badge || null,
                    );
                }, Math.random() * 2000);
            }
        });

        // Initialize timer
        initializeTimer();

        // Initialize progress bar
        initializeProgressBar();

        // Initialize viewers count
        initializeViewerCount();
    });

    // Timer functionality
    function initializeTimer() {
        let timeLeft = 5; // 5 secondes pour test (au lieu de 12 * 60)
        const timerElement = document.getElementById("timerCountdown");
        const timerButton = document.getElementById("timerButton");
        const timerLabel = document.getElementById("timerLabel");

        if (!timerElement || !timerButton || !timerLabel) return;

        const updateTimer = () => {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;

            timerElement.textContent = `${minutes.toString().padStart(2, "0")}:${seconds.toString().padStart(2, "0")}`;

            if (timeLeft <= 0) {
                timerElement.textContent = "D√âBLOQU√â";
                clearInterval(timerInterval);

                // Activer le bouton et changer le texte
                timerButton.classList.remove("disabled");
                timerButton.removeAttribute("disabled");
                timerLabel.textContent = "OFFRE DISPONIBLE";

                // Ajouter le lien de redirection
                timerButton.addEventListener("click", () => {
                    window.location.href = "/offre-speciale";
                });
            } else {
                timeLeft--;
            }
        };

        updateTimer(); // Initial display
        const timerInterval = setInterval(updateTimer, 1000);
    }

    // Progress Bar functionality - Chapitres anim√©s
    function initializeProgressBar() {
        const chapters = document.querySelectorAll(".chapter");
        const totalDuration = 12 * 60 * 1000; // 12 minutes en millisecondes
        const startTime = Date.now();

        // D√©finir les timestamps des chapitres (en secondes)
        const chapterTimestamps = [
            0, // 0:00 - L'introduction
            102.86, // ~1:43 - La preuve (1/7 de 12min)
            205.71, // ~3:26 - Le secret #1 (2/7 de 12min)
            308.57, // ~5:09 - Le secret #2 (3/7 de 12min)
            411.43, // ~6:51 - Le secret #3 (4/7 de 12min)
            514.29, // ~8:34 - Le mensonge (5/7 de 12min)
            617.14, // ~10:17 - La solution (6/7 de 12min)
        ];

        function updateProgress() {
            const elapsed = Date.now() - startTime;
            const currentSecond = elapsed / 1000;

            chapterTimestamps.forEach((timestamp, index) => {
                const nextTimestamp =
                    chapterTimestamps[index + 1] || totalDuration / 1000;

                if (
                    currentSecond >= timestamp &&
                    currentSecond < nextTimestamp
                ) {
                    // Chapitre actif - brille et pulse
                    chapters[index]?.classList.add("active");
                    chapters[index]?.classList.remove("completed");

                    // Calculer le pourcentage de progression dans ce chapitre
                    const chapterDuration = nextTimestamp - timestamp;
                    const chapterElapsed = currentSecond - timestamp;
                    const chapterProgress = Math.min(
                        (chapterElapsed / chapterDuration) * 100,
                        100,
                    );

                    // Mettre √† jour la barre de progression du chapitre
                    const chapter = chapters[index] as HTMLElement;
                    if (chapter) {
                        chapter.style.setProperty(
                            "--chapter-progress",
                            `${chapterProgress}%`,
                        );
                    }
                } else if (currentSecond >= nextTimestamp) {
                    // Chapitre compl√©t√© - reste vert avec check
                    chapters[index]?.classList.remove("active");
                    chapters[index]?.classList.add("completed");

                    // Reset la barre de progression
                    const chapter = chapters[index] as HTMLElement;
                    if (chapter) {
                        chapter.style.setProperty("--chapter-progress", "0%");
                    }
                } else {
                    // Chapitre non atteint - gris
                    chapters[index]?.classList.remove("active", "completed");

                    // Reset la barre de progression
                    const chapter = chapters[index] as HTMLElement;
                    if (chapter) {
                        chapter.style.setProperty("--chapter-progress", "0%");
                    }
                }
            });

            // Continuer l'animation si pas termin√©
            if (elapsed < totalDuration) {
                requestAnimationFrame(updateProgress);
            }
        }

        // D√©marrer l'animation
        requestAnimationFrame(updateProgress);
    }

    // Palette coh√©rente avec le style vert n√©on (20 couleurs)
    const authorPalette = [
        "#00dc82", // Accent principal
        "#00f593", // Accent bright
        "#10b981", // Emerald
        "#34d399", // Emerald light
        "#6ee7b7", // Emerald lighter
        "#14b8a6", // Teal
        "#2dd4bf", // Teal light
        "#5eead4", // Teal lighter
        "#22c55e", // Green
        "#4ade80", // Green light
        "#86efac", // Green lighter
        "#06b6d4", // Cyan
        "#22d3ee", // Cyan light
        "#67e8f9", // Cyan lighter
        "#0891b2", // Cyan dark
        "#84cc16", // Lime
        "#a3e635", // Lime light
        "#bef264", // Lime lighter
        "#00b86b", // Accent dark
        "#10b981", // Emerald variant
    ];

    // Renvoie une couleur hex (ou var) selon un hash du nom
    function getAuthorColor(author: string): string {
        // Couleur sp√©ciale pour l'animateur IA
        if (author === "Animateur") return "var(--accent-bright)";

        // Utiliser la couleur accent pour l'utilisateur (son pr√©nom ou "Vous")
        if (author === "Vous" || author === userFirstName)
            return "var(--accent)";

        let hash = 0;
        for (let i = 0; i < author.length; i++) {
            hash = ((hash << 5) - hash + author.charCodeAt(i)) & 0xffffffff;
        }
        const index = Math.abs(hash) % authorPalette.length;
        return authorPalette[index];
    }

    function addChatMessage(
        author: string,
        message: string,
        badge: string | null = null,
    ) {
        if (!chatMessages) return;
        const messageDiv = document.createElement("div");
        messageDiv.className = "chat-message";
        const colorValue = getAuthorColor(author);
        messageDiv.innerHTML = `
			<div class="message-header">
				<div class="message-author" style="color: ${colorValue};">
					${author}
					${badge ? `<span class="message-badge">${badge}</span>` : ""}
				</div>
			</div>
			<div class="message-content">${message}</div>
		`;
        chatMessages.appendChild(messageDiv);
        chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    function addSystemMessage(message: string, isJoin = false) {
        if (!chatMessages) return;
        const messageDiv = document.createElement("div");
        messageDiv.className = `system-message ${isJoin ? "join" : ""}`;
        messageDiv.textContent = message;
        chatMessages.appendChild(messageDiv);
        chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    // Gestion des onglets
    const publicTab = document.getElementById("publicTab");
    const publicContent = document.getElementById("publicContent");

    // Chat public - juste afficher le message
    const chatForm = document.getElementById("chatForm");
    if (chatForm) {
        chatForm.addEventListener("submit", (e) => {
            e.preventDefault();
            const input = document.getElementById(
                "chatInput",
            ) as HTMLInputElement;
            if (!input) return;
            const message = input.value.trim();
            if (message) {
                // Afficher le message dans le chat public
                addChatMessage(userFirstName, message, null);
                input.value = "";

                // Simulation de r√©ponses des autres participants
                setTimeout(
                    () => {
                        const responses = ["Top!", "+1", "üî•", "Merci", "Cool"];
                        const randomResponse =
                            responses[
                                Math.floor(Math.random() * responses.length)
                            ];
                        const randomName = ["Julie", "Marc", "Sophie", "Alex"][
                            Math.floor(Math.random() * 4)
                        ];
                        addChatMessage(randomName, randomResponse);
                    },
                    2000 + Math.random() * 3000,
                );
            }
        });
    }

    // Viewers count functionality
    function initializeViewerCount() {
        const viewerCountElement = document.getElementById("viewerCount");
        if (!viewerCountElement) return;

        // Valeur initiale al√©atoire entre 32 et 57
        let currentCount = Math.floor(Math.random() * (57 - 32 + 1)) + 32;
        viewerCountElement.textContent = currentCount.toString();

        function updateViewerCount() {
            if (!viewerCountElement) return;

            // G√©n√©rer un nouveau chiffre entre 32 et 57
            const newCount = Math.floor(Math.random() * (57 - 32 + 1)) + 32;

            // Ajouter une classe pour l'animation
            viewerCountElement.classList.add("updating");

            setTimeout(() => {
                if (viewerCountElement) {
                    viewerCountElement.textContent = newCount.toString();
                    viewerCountElement.classList.remove("updating");
                }
            }, 250);
        }

        // Changer le chiffre toutes les 10 √† 20 secondes de fa√ßon al√©atoire
        function scheduleNextUpdate() {
            const delay =
                Math.floor(Math.random() * (20000 - 10000 + 1)) + 10000; // Entre 10 et 20 secondes
            setTimeout(() => {
                updateViewerCount();
                scheduleNextUpdate();
            }, delay);
        }

        scheduleNextUpdate();
    }

    // Floating reactions (disabled)
    function showFloatingReaction(emoji: string) {
        // Disabled for now
    }

    // CTA functions
    function closeCTA() {
        const popup = document.getElementById("ctaPopup");
        if (popup) {
            popup.classList.remove("show");
        }
    }

    function handleCTA() {
        alert("Fonctionnalit√© √† impl√©menter : capture email + t√©l√©chargement");
        closeCTA();
    }

    // Chapter navigation
    document.querySelectorAll(".chapter").forEach((chapter) => {
        chapter.addEventListener("click", () => {
            const time = parseInt((chapter as HTMLElement).dataset.time || "0");
            // Would need YouTube API to seek to time
            document
                .querySelectorAll(".chapter")
                .forEach((c) => c.classList.remove("active"));
            chapter.classList.add("active");
        });
    });
</script>
