---
import Layout from "../../../layouts/Layout.astro";
import "../../../styles/thematiques.css";

export const title = "Test 3 Thématiques";

// Données simplifiées pour test
const thematiques = [
    {
        id: 1,
        title: "Test Finance",
        description: "Test description finance",
        virality: 4,
        financial: 5,
        monetization: ["Formations", "Mentorat"],
        difficulty: 3,
        difficultyText: "Test",
    },
    {
        id: 2,
        title: "Test Gaming", 
        description: "Test description gaming",
        virality: 5,
        financial: 3,
        monetization: ["Streaming", "Affiliation"],
        difficulty: 2,
        difficultyText: "Test gaming",
    },
    {
        id: 3,
        title: "Test Cuisine",
        description: "Test description cuisine", 
        virality: 4,
        financial: 4,
        monetization: ["Livres", "Affiliation"],
        difficulty: 2,
        difficultyText: "Test cuisine",
    }
];
---

<Layout title={title}>
    <div class="thematiques-page">
        <div class="container">
            <div class="header">
                <h1><span class="header-highlight">3</span> Thématiques Test</h1>
                <p class="subtitle">Test de fonctionnement</p>
            </div>

            <div class="grid" id="cardsGrid">
                <!-- Cards will be generated by JavaScript -->
            </div>
        </div>
    </div>

    <script define:vars={{ thematiquesData: thematiques }} client:load>
        console.log("Script chargé, données:", thematiquesData);
        const thematiques = thematiquesData;
        console.log("Nombre de thématiques:", thematiques.length);

        function createStars(rating) {
            let stars = "";
            for (let i = 1; i <= 5; i++) {
                stars += `<div class="star ${i <= rating ? "filled" : ""}"></div>`;
            }
            return stars;
        }

        function createCard(theme) {
            return `
                <div class="card">
                    <div class="card-header">
                        <div class="card-number">${theme.id}</div>
                        <div class="card-title">${theme.title}</div>
                    </div>
                    <p class="card-description">${theme.description}</p>
                    <div class="stars">${createStars(theme.virality)}</div>
                </div>
            `;
        }

        function renderCards() {
            console.log("renderCards appelée");
            const grid = document.getElementById("cardsGrid");
            console.log("Grid trouvé:", !!grid);
            
            if (!grid) {
                console.error("Grid element not found!");
                return;
            }

            console.log("Rendu de", thematiques.length, "cartes");
            grid.innerHTML = thematiques.map(theme => createCard(theme)).join("");
            console.log("Rendu terminé");
        }

        // Test immédiat
        console.log("Appel renderCards immédiat");
        renderCards();

        // Test avec délai
        setTimeout(() => {
            console.log("Appel renderCards avec délai");
            renderCards();
        }, 1000);
    </script>
</Layout>
